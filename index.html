<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Freshers Cup ‚Äì CPE vs FRM</title>
<style>
body{
  margin:0; font-family:sans-serif; background:#0b8f2f; color:#fff; display:flex; justify-content:center; align-items:flex-start; min-height:100vh; padding:20px; box-sizing:border-box;
}
.card{
  background:#1e1e2f; width:100%; max-width:700px; border-radius:20px; padding:25px; box-shadow:0 15px 35px rgba(0,0,0,0.5);
}
.team-row{display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;}
.team{text-align:center; flex:1;}
.team img{width:80px; height:80px; border-radius:50%; border:3px solid #fff; margin-bottom:10px;}
.team h2{margin:0; font-size:22px;}
.score{font-size:48px; font-weight:bold; color:#00ffcc; margin-top:5px;}
.vs{font-size:32px; font-weight:700; color:#ffdd00; margin:0 10px;}
.info-box{background: rgba(255,255,255,0.1); padding:15px; border-radius:12px; margin-bottom:20px;}
.goal-box{background: rgba(255,255,255,0.1); padding:12px; border-radius:12px; margin-bottom:15px;}
.commentary{background: rgba(255,255,255,0.1); border-radius:12px; padding:12px; max-height:150px; overflow-y:auto; margin-bottom:15px;}
.fan-section{background: rgba(255,255,255,0.05); border-radius:12px; padding:12px; margin-bottom:20px;}
.fan-section input{width:70%; padding:6px; border-radius:8px; border:none; margin-right:5px;}
.fan-section button{padding:6px 10px; border-radius:8px; border:none; cursor:pointer; background:#ffdd00; color:#000;}
#fanComments p {
  background: rgba(255,255,255,0.1);
  padding:8px;
  border-radius:8px;
  margin:4px 0;
  position: relative;
}
.deleteComment{position:absolute; right:5px; top:5px; cursor:pointer; color:#ff4444; font-weight:bold;}
.admin-btn{background:#ffdd00;color:#000;border:none;padding:8px 15px;border-radius:12px;cursor:pointer;margin-bottom:10px;}
#adminPanel{display:none;margin-top:10px;background: rgba(255,255,255,0.15); padding:10px; border-radius:12px;}
#adminPanel input, #adminPanel select, #adminPanel button{margin:5px 0;padding:6px;border-radius:8px;border:none;}
#timer{
  font-size:28px; font-weight:700; text-align:center; margin-bottom:10px; 
  color: #00ff00; text-shadow:0 0 8px #00ff00;
}
#liveBar{
  height:6px; width:15%; background:#00ff00; border-radius:3px;
  margin:0 auto 10px auto; display:none;
  animation: liveMove 3s infinite ease-in-out;
}
@keyframes liveMove{
  0% { transform: translateX(-100%) scaleX(0.3); opacity: 0; }
  25% { transform: translateX(0%) scaleX(1); opacity: 1; }
  50% { transform: translateX(100%) scaleX(0.3); opacity: 0; }
  75% { transform: translateX(0%) scaleX(1); opacity: 1; }
  100% { transform: translateX(-100%) scaleX(0.3); opacity: 0; }
}
.floatingHeart {
  position:absolute;
  font-size:24px;
  animation: floatUp 1s ease-out forwards;
  pointer-events:none;
}
@keyframes floatUp {
  0% { opacity:1; transform: translateY(0) scale(1); }
  100% { opacity:0; transform: translateY(-100px) scale(1.5); }
}
#loveButton{
  position:fixed; bottom:30px; right:30px; font-size:40px; cursor:pointer; user-select:none;
}
</style>
</head>
<body>

<div class="card">
  <div id="liveBar"></div>
  <div id="timer">0</div>

  <div class="team-row">
    <div class="team">
      <img src="https://i.ibb.co/XfTKYHJ0/IMG-20251009-WA0089.jpg" alt="CPE Logo">
      <h2>CPE</h2>
      <div class="score" id="scoreCPE"></div>
    </div>
    <div class="vs" id="vsDisplay">VS</div>
    <div class="team">
      <img src="https://i.ibb.co/rR9PL8DG/IMG-20251116-200233.png" alt="FRM Logo">
      <h2>FRM</h2>
      <div class="score" id="scoreFRM"></div>
    </div>
  </div>

  <div class="info-box">
    <p><strong>Competition:</strong> Freshers Cup</p>
    <p><strong>Stage:</strong> Pre-match</p>
    <p><strong>Venue:</strong> Lico Field</p>
    <p><strong>Location:</strong> LAUTECH Ogbomosho</p>
    <p><strong>Weather:</strong> Sunny</p>
    <p><strong>Kick Off:</strong> 11:00 AM</p>
  </div>

  <div class="goal-box">
    <h3>Goal Scorers</h3>
    <p id="goals">None yet</p>
  </div>

  <div class="commentary">
    <h3>Live Updates</h3>
    <div id="liveComments"></div>
  </div>

  <div class="fan-section">
    <h3>Fan Comments ‚ù§Ô∏è</h3>
    <input type="text" id="fanComment" placeholder="Write your comment..." />
    <button onclick="addFanComment()">Send</button>
    <div id="fanComments"></div>
  </div>

  <button class="admin-btn" id="adminBtn">Show Admin Controls</button>
  <div id="adminPanel">
    <label>Stage:</label>
    <select id="stageSelect">
      <option value="PRE">Pre-match</option>
      <option value="FH">First Half</option>
      <option value="HT">Half-time</option>
      <option value="SH">Second Half</option>
      <option value="FT">Full-time</option>
    </select>
    <button onclick="changeStage()">Update Stage</button><br>

    <label>CPE Score:</label><input type="number" id="cpeScore" min="0">
    <button onclick="setScore('CPE')">Update</button><br>

    <label>FRM Score:</label><input type="number" id="frmScore" min="0">
    <button onclick="setScore('FRM')">Update</button><br>

    <label>Goal Scorer:</label><input type="text" id="goalPlayer">
    <button onclick="addGoal()">Add Goal</button><br>

    <label>Commentary:</label><input type="text" id="commentText">
    <button onclick="addCommentary()">Add Comment</button>
  </div>
</div>

<div id="loveButton">üíö</div>

<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
<script>
const firebaseConfig = {
  apiKey: "AIzaSyA2AScPQkOE632znM9vvCahijtnronS3jU",
  authDomain: "fresherscuplive.firebaseapp.com",
  databaseURL: "https://fresherscuplive-default-rtdb.firebaseio.com",
  projectId: "fresherscuplive",
  storageBucket: "fresherscuplive.firebasestorage.app",
  messagingSenderId: "502451588704",
  appId: "1:502451588704:web:56bd4d7fc98814cddfbd05"
};
firebase.initializeApp(firebaseConfig);
const database = firebase.database();
const matchRef = database.ref("match");
const fanRef = database.ref("fanComments");
const loveRef = database.ref("loveCount");

const adminPassword = "CPE2025";
document.getElementById("adminBtn").addEventListener("click", ()=>{
  let pass = prompt("Enter admin password:");
  if(pass === adminPassword){
    document.getElementById("adminPanel").style.display="block";
    document.getElementById("adminBtn").style.display="none";
  } else alert("Wrong password!");
});

let timerInterval = null;

// Match data listener
matchRef.on("value", snapshot => {
  const data = snapshot.val();
  if(!data) return;

  document.getElementById("scoreCPE").textContent = data.scoreCPE || "";
  document.getElementById("scoreFRM").textContent = data.scoreFRM || "";
  document.getElementById("goals").textContent = (data.goalScorers && data.goalScorers.length>0)? data.goalScorers.join(", ") : "None yet";

  const liveDiv = document.getElementById("liveComments");
  liveDiv.innerHTML = "";
  if(data.liveComments) data.liveComments.forEach(c=>{
    const p = document.createElement("p");
    p.textContent=c;
    liveDiv.appendChild(p);
  });

  document.getElementById("vsDisplay").textContent = (data.stage=="PRE")? "VS" : `${data.scoreCPE||0} - ${data.scoreFRM||0}`;

  document.getElementById("liveBar").style.display = (["FH","HT","SH"].includes(data.stage)) ? "block":"none";

  if(data.stage=="FH" || data.stage=="SH"){
    if(data.startTime){
      startLiveTimerFromStartTime(data.startTime, data.stage);
    }
  } else if(data.stage=="HT"){
    document.getElementById("timer").textContent = "HALF-TIME";
    clearInterval(timerInterval);
  } else if(data.stage=="FT"){
    document.getElementById("timer").textContent = "FULL-TIME";
    clearInterval(timerInterval);
  }
});

// Fan comments listener
fanRef.on("value", snapshot=>{
  const data = snapshot.val() || [];
  const fanDiv = document.getElementById("fanComments");
  fanDiv.innerHTML = "";
  data.forEach((c,i)=>{
    const p = document.createElement("p");
    p.textContent=c;
    const delBtn = document.createElement("span");
    delBtn.textContent="√ó";
    delBtn.className="deleteComment";
    delBtn.onclick=()=>deleteFanComment(i);
    p.appendChild(delBtn);
    fanDiv.appendChild(p);
  });
});

function changeStage(){
  const stage = document.getElementById("stageSelect").value;
  if(stage=="FH" || stage=="SH"){
    matchRef.update({stage, startTime: Date.now()});
  } else{
    matchRef.update({stage});
  }
}

function setScore(team){
  const val = (team=="CPE")? Number(document.getElementById("cpeScore").value) : Number(document.getElementById("frmScore").value);
  if(team=="CPE") matchRef.update({scoreCPE:val});
  else matchRef.update({scoreFRM:val});
}

function addGoal(){
  const player = document.getElementById("goalPlayer").value.trim();
  if(!player) return;
  matchRef.child("goalScorers").once("value").then(s=>{
    let arr = s.val()||[];
    arr.push(player);
    matchRef.update({goalScorers:arr});
  });
  document.getElementById("goalPlayer").value="";
}

function addCommentary(){
  const text = document.getElementById("commentText").value.trim();
  if(!text) return;
  matchRef.child("liveComments").once("value").then(s=>{
    let arr = s.val()||[];
    arr.push(text);
    matchRef.update({liveComments:arr});
  });
  document.getElementById("commentText").value="";
}

// Fan comment
function addFanComment(){
  const text = document.getElementById("fanComment").value.trim();
  if(!text) return;
  fanRef.once("value").then(s=>{
    let arr = s.val()||[];
    arr.push(text);
    fanRef.set(arr);
  });
  document.getElementById("fanComment").value="";
}

function deleteFanComment(index){
  fanRef.once("value").then(s=>{
    let arr = s.val()||[];
    arr.splice(index,1);
    fanRef.set(arr);
  });
}

// Floating love button
document.getElementById("loveButton").addEventListener("click", e=>{
  const heart = document.createElement("div");
  heart.className="floatingHeart";
  heart.textContent="üíö";
  heart.style.left=(e.clientX-12)+"px";
  heart.style.top=(e.clientY-12)+"px";
  document.body.appendChild(heart);
  setTimeout(()=>heart.remove(),1000);

  loveRef.once("value").then(s=>{
    let count = s.val()||0;
    loveRef.set(count+1);
  });
});

// Timer function
function startLiveTimerFromStartTime(startTimestamp, stage){
  if(timerInterval) clearInterval(timerInterval);
  timerInterval = setInterval(()=>{
    const now = Date.now();
    let elapsed = Math.floor((now - startTimestamp)/1000 / 60); // minutes only
    let displayTime = "";

    if(stage=="FH"){
      if(elapsed <30) displayTime = `${elapsed}`;
      else displayTime = `30 +${elapsed-30}`;
    } else if(stage=="SH"){
      elapsed +=30; // start second half from 30
      if(elapsed <60) displayTime = `${elapsed}`;
      else displayTime = `60 +${elapsed-60}`;
    }

    document.getElementById("timer").textContent = displayTime;
  },1000);
}
</script>
</body>
</html>
